**JOIN**

- JOIN이 필요한 기본적인 이유는 과목1에서 배운 정규화에서부터 출발한다. 정규화란 불필요한 데이터의 정합성을 확보하고 이상현상(Anomaly) 발생을 피하기 위해, 테이블을 분할하여 생성하는 것이다.
- 데이터웨어하우스 모델처럼 하나의 테이블에 모든 데이터를 집중시켜놓고(반정규화/비정규화) 그 테이블로부터 필요한 데이터를 조회할 수도 있다. 그러나 이렇게 됐을 경우, 가장 중요한 데이터의 정합성에 더 큰 비용을 지불해야 하며, 데이터를 추가, 삭제, 수정하는 작업 역시 상당한 노력이 요구될 것이다. 성능 측면에서도 간단한 데이터를 조회하는 경우에도 규모가 큰 테이블에서 필요한 데이터를 찾아야 하기 때문에 오히려 검색 속도가 떨어질 수도 있다
- 테이블을 정규화하여 데이터를 분할하게 되면 위와 같은 문제는 자연스럽게 해결된다. 하지만 특정 요구조건을 만족하는 데이터들을 분할된 테이블로부터 조회하기 위해서는 테이블 간에 논리적인 연관관계가 필요하고 그런 관계성을 통해서 다양한 데이터들을 조회할 수 있는 것이다. 그리고, 이런 논리적인 관계를 성립시켜주는 것이 바로 JOIN 조건인 것이다. 유연한 JOIN 기능은 관계형 데이터베이스의 가장 큰 장점이라고 할 수 있다
- 두 개 이상의 테이블 들을 연결 또는 결합하여 데이터를 조회하는 것을 JOIN이라고 하며, 일반적으로 사용되는 SQL 문장의 상당수가 JOIN이라고 생각하면 JOIN의 중요성을 이해하기 쉬울 것이다. 조인은 관계형 데이터베이스의 가장 큰 장점이면서 기본적인 기능이라고 할 수 있다
- 일반적인 경우 행들은 PRIMARY KEY나 FOREIGN KEY 값의 연관에 의해 JOIN이 성립된다. 하지만 어떤 경우에는 이러한 PK, FK의 관계가 없어도 논리적인 값들의 연관성만으로 JOIN이 성립 가능하다. 이 기능은 계층형이나 망형 데이터베이스와 비교해서 관계형 데이터베이스의 큰 장점이다
- 주의할 점은 FROM 절에 여러 테이블이 나열되더라도 SQL에서 데이터를 처리할 때는 단 두개의 집합 간에만 조인이 일어난다는 것이다. FROM 절에 A, B, C 테이블이 나열되었더라도 특정 2개의 테이블만 먼저 조인 처리되고, 2개의 테이블이 조인디어서 처리된 새로운 데이터 집합과 남은 한 개의 테이블이 다음 차례로 조인 되는 것이다. 이 순서는 4개 이상의 테이블이 사용되더라도 같은 프로세스로 반복된다
- JOIN에 참여하는 대상 테이블이 N개라고 했을 때, N개의 테이블로부터 필요한 데이터를 조회하기 위해 필요한 JOIN 조건은 대상 테이블의 개수에서 하나를 뺀 N-1개 이상이 필요하다.

**EQUI JOIN**

- EQUI(등가) JOIN은 두 개의 테이블 간에 칼럼 값들이 서로 정확하게 일치하는 경우에 사용되는 방법으로 대부분 PK<->FK의 관계를 기반으로 한다. 그러나 일반적으로 테이블 설계 시에 나타난 PK<->FK 의 관계를 이용하는 것이지 반드시 PK<->FK의 관계로만 EQUI JOIN이 성립하는 것은 아니다
- 고전적인 JOIN의 조건은 WHERE 절에 기술하게 되는데 EQUI JOIN은 "=" 연산자를 사용해서 표현한다. ![스크린샷 2023-11-03 오후 5.37.05](/Users/asthu/Library/Application Support/typora-user-images/스크린샷 2023-11-03 오후 5.37.05.png)
- ![스크린샷 2023-11-03 오후 5.40.29](/Users/asthu/Library/Application Support/typora-user-images/스크린샷 2023-11-03 오후 5.40.29.png)
- SQL 문장에 단순히 칼럼명이 오지 않고 "테이블명.칼럼명"처럼 테이블명과 칼럼명이 같이 명시하는 것은 두 가지 이유가 있다
  - 먼저 모든 테이블에 칼럼들이 유일한 이름을 가진다면 상관 없지만, JOIN에 사용되는 두 개의 테이블에 같은 칼럼명(TEAM_ID)이 존재하는 경우에는 DBMS의 옵티마이저는 어떤 칼럼을 사용해야 할지 모르기 때문에 파싱 단계에서 에러가 발생된다
  - 두번째는 개발자나 사용자가 조회할 데이터가 어느 테이블에 있는 칼럼을 말하는 것인지 쉽게 알 수 있게 하므로 SQL에 대한 가독성이나 유지보수성을 높이는 효과가 있다
  - 조회할 칼럼명 앞에서 테이블명을 붙여서 사용하는 습관을 기르는 것을 권장하지만, 하나의 SQL 문장 내에서 유일하게 사용하는 칼럼명이라면 칼럼명 앞에 테이블 명을 붙이지 않아도 된다
- ![스크린샷 2023-11-03 오후 5.46.25](/Users/asthu/Library/Application Support/typora-user-images/스크린샷 2023-11-03 오후 5.46.25.png)
- JOIN 대상이 되는 테이블명이 조회하고자 하는 칼럼 앞에 반복해서 나오는 것을 알 수 있다. 긴 테이블명을 계속 되풀이해서 입력하다보면 개발 생산성이 떨어지는 문제점과 함께 개발자의 실수가 발생할 가능성이 높아지는 문제가 있다

**EQUI JOIN - TABLE ALIAS**

- SELECT 절에서 칼럼에 대한 ALIAS를 사용하는 것처럼 FROM 절의 테이블에 대해서도 ALIAS를 사용할 수 있다. 단일 테이블을 사용하는 SQL 문장에서는 필요성은 없지만 사용하더라도 에러는 발생하지 않으며, 여러 테이블을 사용하는 조인을 이용하는 경우는 매우 유용하게 사용할 수 있다
- 만약 테이블에 대한 ALIAS를 적용해서 SQL 문장을 작성했을 경우, WHERE 절과 SELECT 절에는 테이블명이 아닌 테이블에 대한 ALIAS를 사용해야 한다(미사용시 문법 에러 발생). 그러나, 하나의 SQL 문장 내에서 유일하게 사용하는 칼럼명이라면 칼럼명 앞에 ALIAS를 붙이지 않아도 된다
- ![스크린샷 2023-11-06 오후 4.09.40](/Users/asthu/Library/Application Support/typora-user-images/스크린샷 2023-11-06 오후 4.09.40.png)
- 테이블(개수 -1)개의 JOIN 조건을 WHERE 절에 명시하고, 부수적으로 제한 조건을 논리 연산자를 통하여 추가로 입력하는 것이 가능하다
- ![스크린샷 2023-11-06 오후 4.10.13](/Users/asthu/Library/Application Support/typora-user-images/스크린샷 2023-11-06 오후 4.10.13.png)
- ![스크린샷 2023-11-06 오후 4.22.50](/Users/asthu/Library/Application Support/typora-user-images/스크린샷 2023-11-06 오후 4.22.50.png)
- ![스크린샷 2023-11-06 오후 4.22.59](/Users/asthu/Library/Application Support/typora-user-images/스크린샷 2023-11-06 오후 4.22.59.png)
- 실무에서는 테이블 ALIAS를 적용하고, 유지보수성과 가독성을 위해 유니크한 칼럼명에도 테이블 ALIAS를 적용한 두번째 SQL문장 형식을 권고한다
- ![스크린샷 2023-11-06 오후 4.23.31](/Users/asthu/Library/Application Support/typora-user-images/스크린샷 2023-11-06 오후 4.23.31.png)

**3개 이상 테이블 JOIN**

- ![스크린샷 2023-11-06 오후 4.24.09](/Users/asthu/Library/Application Support/typora-user-images/스크린샷 2023-11-06 오후 4.24.09.png)

**Non EQUI JOIN**

- 두 개의 테이블이 PK-FK로 연관관계를 가지거나 논리적으로 같은 값이 존재하는 경우에는 "=" 연산자를 이용하여 EQUI JOIN을 사용한다. 그러나 두 개의 테이블 간에 칼럼 값들이 서로 정확하게 일치하지 않는 경우에는 EQUI JOIN을 사용할 수 없다

- 이런 경우 Non EQUI JOIN을 시도하는데, "=" 연산자가 아닌 다른 (Between, >, >=, <, <= 등) 연산자들을 사용하여 JOIN을 수행하는 것이다

- 데이터 모델에 따라서 Non EQUI JOIN이 불가능한 경우도 있다. 아래 BETWEEN a AND b 조건은 Non EQUI JOIN의 한 사례일 뿐이다

- ![스크린샷 2023-11-06 오후 4.27.26](/Users/asthu/Library/Application Support/typora-user-images/스크린샷 2023-11-06 오후 4.27.26.png)

- ![스크린샷 2023-11-06 오후 4.27.43](/Users/asthu/Library/Application Support/typora-user-images/스크린샷 2023-11-06 오후 4.27.43.png)

  